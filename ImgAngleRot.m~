
%Finding angles of rotation for the different subjects for Y and Z%
Data=xlsread('/Users/finks/Desktop/Projects/STN_Figure/STN_Midline.xlsx');

%Calculation for Z rotation - Use Dorsal and Ventral Points%
DPx=Data(:,8);
DPz=Data(:,10);
VPx=Data(:,11);
VPz=Data(:,13);
Deltax=(DPx-VPx);
Deltaz=(DPz-VPz);
theta1=atand(Deltax./Deltaz);
angley=90-theta1;

%Calculation for Y rotation - Use ACPC  Points%

ACx=Data(:,14);
ACy=Data(:,15);
PCx=Data(:,17);
PCy=Data(:,18);
Deltax=(ACx-PCx);
Deltay=(ACy-PCy);
anglez=atand(Deltax./Deltay);

%locating MCP

ACx=Data(:,14);
ACy=Data(:,15);
ACz=Data(:,16);
PCx=Data(:,17);
PCy=Data(:,18);
PCz=Data(:,19);
X=(ACx+PCx)./2;
Y=(ACy+PCy)./2;
Z=(ACz+PCz)./2;
MCP=[X,Y,Z];

%Calculation for X rotation - use AC and MCP

Deltaz=ACz-MCP(:,3);
Deltay=MCP(:,2)-ACy;
anglex=atand(Deltaz./Deltay);